<div class="row g-0" style="height: calc(100vh - 64px);">
  <!-- COLONNE GAUCHE (Liste) -->
  <div id="panel-list" class="col-12 col-md-3 nav-saas-panel">
    <div class="nav-saas-header">
      <span class="nav-saas-title">Mes Modèles</span>
      <button class="btn-icon-soft" onclick="createNewTemplate()" title="Nouveau modèle"><i class="bi bi-plus-lg"></i></button>
    </div>
    <!-- La liste scrolle indépendamment grâce au flex du parent nav-saas-panel -->
    <div id="templatesList" class="nav-saas-list custom-scrollbar"></div>
  </div>

  <!-- COLONNE DROITE (ÉDITEUR FIXE) -->
  <!-- Ajout de fixed-panel-layout -->
  <div id="panel-editor" class="col-12 col-md-9 bg-white fixed-panel-layout" style="display:none !important;">
    
    <!-- HEADER FIXE -->
    <div class="fixed-panel-header px-4 py-2 d-flex justify-content-between align-items-center">
      <button class="btn btn-link text-dark p-0 me-3 d-md-none" onclick="showMobileList()"><i class="bi bi-arrow-left fs-4"></i></button>
      <div class="flex-grow-1 me-3">
         <div class="input-group input-group-sm">
            <span class="input-group-text border-0 bg-transparent text-muted small px-0">Fichier :</span>
            <input type="text" id="tplName" class="form-control border-0 fw-bold text-dark shadow-none bg-transparent" placeholder="Nom pour l'admin..." oninput="setDirty(true)">
         </div>
      </div>
      <div class="d-flex align-items-center">
        <input type="hidden" id="tplRowIndex"><input type="hidden" id="tplId">
        <div class="text-secondary small me-3 fst-italic" id="saveStatus"></div>
        <button class="btn btn-sm btn-link text-danger text-decoration-none me-2" onclick="deleteCurrentTemplate()"><i class="bi bi-trash"></i></button>
        <button class="btn btn-sm btn-primary-notion" onclick="saveTemplate()">Sauvegarder</button>
      </div>
    </div>

    <!-- CORPS SCROLLABLE -->
    <div class="fixed-panel-body px-5 py-4 custom-scrollbar">
      <div id="templateHeaderPlaceholder"></div>
      <div id="blocksContainer" class="d-flex flex-column pb-2 w-100 mx-auto" style="max-width: 900px;"></div>
      <div class="text-muted mt-2 p-5 text-center hidden" id="emptyTplMsg"><i class="bi bi-plus-circle display-4 opacity-25 mb-3 d-block"></i>Commencez à écrire votre liturgie.</div>
      <div class="add-zone-final p-3 text-secondary opacity-50 hover-opacity-100 cursor-pointer text-center mx-auto" style="max-width: 900px;" onclick="openInsertMenu(-1, this)"><i class="bi bi-plus-lg me-2"></i>Ajouter un bloc</div>
      <div style="height: 150px;"></div>
    </div>
  </div>
  
  <div class="col-md-9 d-none d-md-flex align-items-center justify-content-center text-muted bg-white" id="emptyStatePanel"><div class="text-center opacity-50"><i class="bi bi-file-earmark-text display-1 mb-3"></i><p>Sélectionnez un modèle à gauche.</p></div></div>
</div>

<div id="menuOverlay" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:1040; cursor:default;"></div>
<div id="insertMenu" class="dropdown-menu custom-popup" style="display:none; position:absolute; z-index:1050; width: 180px;">
  <h6 class="dropdown-header">STRUCTURE</h6>
  <button class="dropdown-item" onclick="insertBlock('TITRE')">Titre de section</button>
  <div class="dropdown-divider my-1 opacity-50"></div>
  <h6 class="dropdown-header">CONTENU</h6>
  <button class="dropdown-item" onclick="insertBlock('CHANT')">Chant / Hira</button>
  <button class="dropdown-item" onclick="insertBlock('FANEKENA')">Confession de foi</button>
  <button class="dropdown-item" onclick="insertBlock('LECTURE')">Lecture Biblique</button>
  <button class="dropdown-item" onclick="insertBlock('LITURGIE')">Texte Liturgique</button>
  <button class="dropdown-item" onclick="insertBlock('PREDICATION')">Prédication</button>
  <button class="dropdown-item" onclick="insertBlock('PRIERE')">Prière</button>
  <button class="dropdown-item" onclick="insertBlock('ANNONCE')">Annonces</button>
  <button class="dropdown-item" onclick="insertBlock('LIBRE')">Section libre</button>
  <button class="dropdown-item" onclick="insertBlock('TEXTE_LIBRE')">Texte libre</button>
</div>
<div id="roleMenu" class="dropdown-menu custom-popup" style="display:none; position:absolute; z-index:1050; width: 180px;"></div>